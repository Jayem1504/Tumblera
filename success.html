<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Success - Tumblera</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50 min-h-full flex flex-col">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-2 sm:px-4 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center pl-4">
                    <img src="images/tumblera-word-only.jpg" alt="Tumblera" class="h-8 sm:h-10 object-contain">
                </div>
                <div class="flex items-center space-x-1 sm:space-x-2 md:space-x-4">
                    <a href="index.html" class="text-gray-700 hover:text-amber-800 px-2 sm:px-3 py-2 font-medium text-sm sm:text-base border-b-2 border-transparent">
                        <i class="fas fa-home"></i><span class="hidden sm:inline ml-1"> Home</span>
                    </a>
                    <a href="customize.html" class="text-gray-700 hover:text-amber-800 px-2 sm:px-3 py-2 font-medium text-sm sm:text-base border-b-2 border-transparent">
                        <i class="fas fa-paint-brush"></i><span class="hidden sm:inline ml-1"> Customize</span>
                    </a>
                    <a href="orders.html" class="text-gray-700 hover:text-amber-800 px-2 sm:px-3 py-2 font-medium text-sm sm:text-base border-b-2 border-transparent">
                        <i class="fas fa-box"></i><span class="hidden sm:inline ml-1"> Track Orders</span>
                    </a>
                    <a href="cart.html" class="relative text-gray-700 hover:text-amber-800 px-2 sm:px-3 py-2 font-medium text-sm sm:text-base border-b-2 border-transparent">
                        <i class="fas fa-shopping-cart"></i><span class="hidden sm:inline ml-1"> Cart</span>
                        <span id="cart-count" class="absolute -top-1 -right-1 bg-amber-700 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs">0</span>
                    </a>
                    <div id="auth-links" class="flex items-center space-x-1 sm:space-x-2">
                        <a href="login.html" class="text-gray-700 hover:text-amber-800 px-2 sm:px-3 py-2 font-medium text-sm sm:text-base border-b-2 border-transparent">
                            <i class="fas fa-sign-in-alt"></i><span class="hidden sm:inline ml-1"> Login</span>
                        </a>
                        <a href="signup.html" class="text-gray-700 hover:text-amber-800 px-2 sm:px-3 py-2 font-medium text-sm sm:text-base border-b-2 border-transparent">
                            <i class="fas fa-user-plus"></i><span class="hidden sm:inline ml-1"> Sign Up</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Success Content -->
    <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
        <div class="bg-white rounded-lg shadow-lg p-8 text-center">
            <!-- Success Icon -->
            <div class="mb-6">
                <div class="mx-auto w-24 h-24 bg-green-100 rounded-full flex items-center justify-center">
                    <i class="fas fa-check-circle text-green-500 text-5xl"></i>
                </div>
            </div>

            <!-- Success Message -->
            <h1 class="text-3xl font-bold text-gray-800 mb-4">Order Placed Successfully!</h1>
            <p class="text-lg text-gray-600 mb-2">Thank you for your order!</p>
            <p class="text-gray-500 mb-8">We've received your order and will start preparing your custom tumbler(s) right away.</p>

            <!-- Order Details -->
            <div class="bg-gray-50 rounded-lg p-6 mb-8 text-left">
                <h2 class="text-xl font-semibold mb-4 text-center">Order Summary</h2>
                <div class="space-y-2">
                    <div class="flex flex-col gap-1">
                        <span class="text-gray-600 text-sm">Order ID:</span>
                        <div class="flex items-center gap-2 bg-white p-2 rounded border">
                            <span id="order-number" class="font-mono text-xs text-amber-800 break-all flex-1">Loading...</span>
                            <button 
                                onclick="copyOrderId()" 
                                id="copy-btn"
                                class="px-3 py-1 bg-amber-600 text-white text-xs rounded hover:bg-amber-700 transition shrink-0"
                                title="Copy Order ID">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <span class="text-xs text-gray-500">
                            <i class="fas fa-info-circle mr-1"></i>Save this ID to track your order
                        </span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Order Date:</span>
                        <span id="order-date" class="font-semibold">Loading...</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Total Items:</span>
                        <span id="total-items" class="font-semibold">Loading...</span>
                    </div>
                    <div class="flex justify-between border-t pt-2 mt-2">
                        <span class="text-gray-600 text-lg">Total Amount:</span>
                        <span id="total-amount" class="font-bold text-lg text-amber-800">Loading...</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Payment Method:</span>
                        <span class="font-semibold text-yellow-600">
                            <i class="fas fa-hand-holding-usd mr-1"></i>Cash on Delivery
                        </span>
                    </div>
                </div>
            </div>

            <!-- Next Steps -->
            <div class="bg-amber-50 border border-blue-200 rounded-lg p-6 mb-8 text-left">
                <h3 class="font-semibold text-blue-900 mb-3">What happens next?</h3>
                <ul class="space-y-2 text-sm text-blue-800">
                    <li class="flex items-start">
                        <i class="fas fa-envelope text-amber-800 mt-1 mr-3"></i>
                        <span>You'll receive a confirmation email with your order details</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-paint-brush text-amber-800 mt-1 mr-3"></i>
                        <span>We'll start customizing your tumbler(s) according to your design</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-shipping-fast text-amber-800 mt-1 mr-3"></i>
                        <span>Your order will be delivered within 5-7 business days</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-money-bill-wave text-amber-800 mt-1 mr-3"></i>
                        <span>Pay cash when you receive your order</span>
                    </li>
                </ul>
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="orders.html" class="bg-amber-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-amber-700 transition">
                    <i class="fas fa-box mr-2"></i>Track My Order
                </a>
                <a href="index.html" class="bg-gray-200 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-300 transition">
                    <i class="fas fa-home mr-2"></i>Back to Home
                </a>
                <a href="customize.html" class="bg-gradient-to-r from-stone-500 via-stone-400 to-stone-500 text-white px-6 py-3 rounded-lg font-semibold hover:from-stone-600 hover:via-stone-500 hover:to-stone-600 transition">
                    <i class="fas fa-plus mr-2"></i>Order Another
                </a>
            </div>

            <!-- Contact Info -->
            <div class="mt-8 pt-8 border-t text-sm text-gray-500">
                <p>Need help with your order? Have questions?</p>
                <p class="mt-2">Check your email for order confirmation and tracking details.</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p>&copy; 2025 Tumblera. All rights reserved.</p>
            <p class="text-gray-400 text-sm mt-2">Custom tumblers made with love</p>
        </div>
    </footer>

    <script>
        // Copy order ID to clipboard
        function copyOrderId() {
            const orderNumber = document.getElementById('order-number').textContent;
            const copyBtn = document.getElementById('copy-btn');
            
            navigator.clipboard.writeText(orderNumber).then(() => {
                // Show success feedback
                const originalHTML = copyBtn.innerHTML;
                copyBtn.innerHTML = '<i class="fas fa-check"></i>';
                copyBtn.classList.add('bg-green-600');
                copyBtn.classList.remove('bg-amber-600');
                
                setTimeout(() => {
                    copyBtn.innerHTML = originalHTML;
                    copyBtn.classList.remove('bg-green-600');
                    copyBtn.classList.add('bg-amber-600');
                }, 2000);
            }).catch(err => {
                alert('Failed to copy order ID');
            });
        }
        
        // Load order details from session storage
        window.addEventListener('DOMContentLoaded', function() {
            const orderData = JSON.parse(sessionStorage.getItem('lastOrder') || '{}');
            
            // Display order ID (UUID from database)
            document.getElementById('order-number').textContent = orderData.orderId || 'N/A';
            
            // Display order date
            const orderDate = new Date();
            document.getElementById('order-date').textContent = orderDate.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Display total items
            document.getElementById('total-items').textContent = orderData.itemCount || 0;
            
            // Display total amount
            document.getElementById('total-amount').textContent = orderData.total || '$0.00';
            
            // Update cart count
            const cart = JSON.parse(localStorage.getItem('tumblerCart') || '[]');
            document.getElementById('cart-count').textContent = cart.length;
            
            // Clear session storage after displaying
            sessionStorage.removeItem('lastOrder');
        });
    </script>
    <script type="module">
        // Update navbar for logged-in users
        import { updateNavbar } from './js/supabase.js';
        (async () => {
            await updateNavbar();
        })();
    </script>
</body>
</html>
